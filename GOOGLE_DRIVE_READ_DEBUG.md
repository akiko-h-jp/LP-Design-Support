# Google Drive読み込み機能のデバッグ

## 実装内容

Google Driveからデータを読み込んでUIに表示する機能を実装しました。

### 修正内容

1. **Google Docsファイルのエクスポート対応**
   - JSONファイルはGoogle Docsファイルとして保存されているため、`export`メソッドを使用して読み込むように修正

2. **エラーハンドリングの改善**
   - Google Drive APIのエラーが発生しても、ビルドが失敗しないように修正
   - エラーが発生した場合は、一時保存のデータのみを返す

---

## デバッグ方法

### 1. ブラウザのコンソールを確認

1. ブラウザの開発者ツール（F12）を開く
2. **Console**タブを確認
3. エラーメッセージを確認

### 2. ネットワークタブを確認

1. ブラウザの開発者ツール（F12）を開く
2. **Network**タブを確認
3. `/api/client-input/list`のリクエストを確認
4. レスポンスを確認

### 3. Vercelのログを確認

1. Vercelダッシュボードで**Deployments**タブを開く
2. 最新のデプロイメントをクリック
3. **Logs**タブを開く
4. エラーメッセージを確認

---

## よくある問題

### 問題1: Google Drive APIの認証エラー

**症状**: プロジェクト一覧が表示されない

**確認事項**:
- `GOOGLE_DRIVE_CREDENTIALS_JSON`がVercelの環境変数に設定されているか
- `GOOGLE_DRIVE_FOLDER_ID`がVercelの環境変数に設定されているか

**解決方法**:
1. Vercelダッシュボードで**Settings** → **Environment Variables**を確認
2. 環境変数が設定されているか確認
3. 設定されていない場合は追加

### 問題2: フォルダ名の形式が正しくない

**症状**: プロジェクト一覧に一部のプロジェクトが表示されない

**確認事項**:
- フォルダ名が「案件番号_商品名」形式（例: `2026-001_サンプルサービス`）になっているか

**解決方法**:
- フォルダ名の形式を確認
- 形式が正しくない場合は、フォルダ名を修正

### 問題3: JSONファイルが見つからない

**症状**: プロジェクト一覧に表示されるが、詳細が表示されない

**確認事項**:
- フォルダ内に「01_クライアント事前入力.json」ファイルが存在するか

**解決方法**:
- Google Driveでフォルダを確認
- JSONファイルが存在しない場合は、再度「Google Driveに保存」を実行

---

## ログの確認

### サーバーサイドのログ

Vercelのログで以下のメッセージを確認：

- `Google Driveからプロジェクト一覧取得エラー:` - Google Drive APIのエラー
- `フォルダ ${folder.name} の処理エラー:` - 特定のフォルダの処理エラー
- `フォルダ ${folder.name} のJSONファイル解析エラー:` - JSONファイルの解析エラー

### クライアントサイドのログ

ブラウザのコンソールで以下のメッセージを確認：

- `[API] Error fetching from Google Drive:` - API呼び出し時のエラー

---

## 次のステップ

1. デプロイが完了したら、プロジェクト一覧を確認
2. エラーが発生する場合は、上記のデバッグ方法を試す
3. エラーメッセージを共有してください
